<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 3.7.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"xdksx.github.io","root":"/","scheme":"Gemini","version":"7.7.2","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":true,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="关于编译链接执行，编译器和cpu相关目标： 学完这个部分的知识和调试方法后，一方面可以在写程序时，减少编译错误等，在遇到编译和运行时错误，可以更快的解决或者知道怎么解决，用什么工具可以更快的解决，另一方面，在处理cpu高载，dump问题时，能知道怎么处理和更好的处理；">
<meta name="keywords" content="compilelink">
<meta property="og:type" content="article">
<meta property="og:title" content="cprogram_generate">
<meta property="og:url" content="https://xdksx.github.io/2021/02/20/cprogram-generate/index.html">
<meta property="og:site_name" content="追光者">
<meta property="og:description" content="关于编译链接执行，编译器和cpu相关目标： 学完这个部分的知识和调试方法后，一方面可以在写程序时，减少编译错误等，在遇到编译和运行时错误，可以更快的解决或者知道怎么解决，用什么工具可以更快的解决，另一方面，在处理cpu高载，dump问题时，能知道怎么处理和更好的处理；">
<meta property="og:locale" content="zh-CN">
<meta property="og:updated_time" content="2021-04-24T14:25:46.255Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="cprogram_generate">
<meta name="twitter:description" content="关于编译链接执行，编译器和cpu相关目标： 学完这个部分的知识和调试方法后，一方面可以在写程序时，减少编译错误等，在遇到编译和运行时错误，可以更快的解决或者知道怎么解决，用什么工具可以更快的解决，另一方面，在处理cpu高载，dump问题时，能知道怎么处理和更好的处理；">

<link rel="canonical" href="https://xdksx.github.io/2021/02/20/cprogram-generate/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true
  };
</script>

  <title>cprogram_generate | 追光者</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">追光者</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
        <p class="site-subtitle">小兴的博客</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-首页">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-关于">

    <a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a>

  </li>
        <li class="menu-item menu-item-标签">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-分类">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-归档">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-观影">

    <a href="/movies/" rel="section"><i class="fa fa-fw fa-film"></i>观影</a>

  </li>
        <li class="menu-item menu-item-阅读">

    <a href="/read/" rel="section"><i class="fa fa-fw fa-book"></i>阅读</a>

  </li>
        <li class="menu-item menu-item-心理">

    <a href="/categories/心理/" rel="section"><i class="fa fa-fw fa-heart"></i>心理</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="off"
           placeholder="搜索..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://xdksx.github.io/2021/02/20/cprogram-generate/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/headicon2.jpg">
      <meta itemprop="name" content="小兴">
      <meta itemprop="description" content="始于歧路，愿归于征途">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="追光者">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          cprogram_generate
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2021-02-21 01:27:32" itemprop="dateCreated datePublished" datetime="2021-02-21T01:27:32+08:00">2021-02-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2021-04-24 22:25:46" itemprop="dateModified" datetime="2021-04-24T22:25:46+08:00">2021-04-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/c-cpp/" itemprop="url" rel="index"><span itemprop="name">c&cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h3 id="关于编译链接执行，编译器和cpu相关"><a href="#关于编译链接执行，编译器和cpu相关" class="headerlink" title="关于编译链接执行，编译器和cpu相关"></a>关于编译链接执行，编译器和cpu相关</h3><p>目标： 学完这个部分的知识和调试方法后，一方面可以在写程序时，减少编译错误等，在遇到编译和运行时错误，可以更快的解决或者知道怎么解决，用什么工具可以<br>更快的解决，另一方面，在处理cpu高载，dump问题时，能知道怎么处理和更好的处理； <a id="more"></a></p>
<h3 id="一个简单例子"><a href="#一个简单例子" class="headerlink" title="一个简单例子"></a>一个简单例子</h3><p>说明linux下程序的预处理，编译，链接，运行的整个过程；<br>三个文件如下：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">main.cpp                               |func.cpp                               |func.h</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;                      |#include "func.h"                      |int funcc(int a1);</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;unistd.h&gt;                     |int g_m = 3;                           |</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;                     |extern int g_n ;                       |~                                      </span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"func.h"</span>                      |int funcc(int a1)                      |~                                      </span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> g_m;                        |&#123;                                      |~                                      </span><br><span class="line"><span class="keyword">int</span> g_n = <span class="number">3</span>;                           |    <span class="keyword">int</span> res = a1+<span class="number">3</span>+g_n;                |~                                      </span><br><span class="line">int main()                             |    return res;                        |~                                      </span><br><span class="line">&#123;                                      |&#125;                                      |~                                      </span><br><span class="line">    <span class="keyword">int</span> g_x = <span class="number">3</span>;                       |                                       |~                                      </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"hello"</span>);                   |~                                      |~                                      </span><br><span class="line">    setuid(<span class="number">234323</span>);                    |~                                      |~                                      </span><br><span class="line">    <span class="keyword">int</span> c = funcc(g_x+<span class="number">2</span>);              |~                                      |~                                      </span><br><span class="line">    <span class="keyword">int</span> *i = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) *|~                                      |~                                      </span><br><span class="line"><span class="number">2</span>);                                    |~                                      |~                                      </span><br><span class="line">    *i = <span class="number">2</span>;                            |~                                      |~                                      </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d  %lx\n"</span>,*i,i);          |~                                      |~                                      </span><br><span class="line">    <span class="built_in">free</span>(i);                           |~                                      |~                                      </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;                          |~                                      |~                                      </span><br><span class="line">&#125;                                      |~                                      |~</span><br></pre></td></tr></table></figure></p>
<h4 id="各自预处理后："><a href="#各自预处理后：" class="headerlink" title="各自预处理后："></a>各自预处理后：</h4><p>gcc -E test.c -o test.i 或 gcc -E test.c<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">func.i:</span><br><span class="line"># <span class="number">1</span> <span class="string">"func.cpp"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;built-in&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;command-line&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/stdc-predef.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;command-line&gt;"</span> <span class="number">2</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"func.cpp"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"func.h"</span> <span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">funcc</span><span class="params">(<span class="keyword">int</span> a1)</span></span>;</span><br><span class="line"># <span class="number">2</span> <span class="string">"func.cpp"</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">int</span> g_m = <span class="number">3</span>;</span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> g_n ;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">funcc</span><span class="params">(<span class="keyword">int</span> a1)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> res = a1+<span class="number">3</span>+g_n;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">main.i:</span><br><span class="line">前面展开太多，不贴了：</span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="keyword">void</span> <span class="title">swab</span> <span class="params">(<span class="keyword">const</span> <span class="keyword">void</span> *__restrict __from, <span class="keyword">void</span> *__restrict __to,</span></span></span><br><span class="line">    ssize_t __n) throw () __attribute__ ((__nonnull__ (1, 2)));</span><br><span class="line"># <span class="number">1151</span> <span class="string">"/usr/include/unistd.h"</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line">&#125;</span><br><span class="line"># <span class="number">3</span> <span class="string">"main.cpp"</span> <span class="number">2</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"func.h"</span> <span class="number">1</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">funcc</span><span class="params">(<span class="keyword">int</span> a1)</span></span>;</span><br><span class="line"># <span class="number">4</span> <span class="string">"main.cpp"</span> <span class="number">2</span></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">int</span> g_m;</span><br><span class="line"><span class="keyword">int</span> g_n = <span class="number">3</span>;                           </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span>                             </span></span><br><span class="line"><span class="function"></span>&#123;                                      </span><br><span class="line">    <span class="keyword">int</span> g_x = <span class="number">3</span>;                       </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"hello"</span>);                   </span><br><span class="line">    setuid(<span class="number">234323</span>);                    </span><br><span class="line">    <span class="keyword">int</span> c = funcc(g_x+<span class="number">2</span>);              </span><br><span class="line">    <span class="keyword">int</span> *i = (<span class="keyword">int</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) *<span class="number">2</span>);                                    </span><br><span class="line">    *i = <span class="number">2</span>;                            </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d  %lx\n"</span>,*i,i);          </span><br><span class="line">    <span class="built_in">free</span>(i);                           </span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;                          </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h4 id="接着编译为汇编文件："><a href="#接着编译为汇编文件：" class="headerlink" title="接着编译为汇编文件："></a>接着编译为汇编文件：</h4><p>gcc -S main.cpp<br>gcc -S func.cpp<br>从下面可以看到，已经对程序进行基本分段了，有数据段，代码段等，对全局变量，有专门的段来存取，对未确定的符号，用类型和等标识；<br>汇编语言和特定的cpu有关；<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">        .file   <span class="string">"main.cpp"</span>                                                |        .file   <span class="string">"func.cpp"</span></span><br><span class="line">        .globl  g_n                                                       |        .globl  g_m</span><br><span class="line">        .data                                                             |        .data</span><br><span class="line">        .align <span class="number">4</span>                                                          |        .align <span class="number">4</span></span><br><span class="line">        .type   g_n, @object                                              |        .type   g_m, @object</span><br><span class="line">        .size   g_n, <span class="number">4</span>                                                    |        .size   g_m, <span class="number">4</span></span><br><span class="line">g_n:                                                                      |g_m:</span><br><span class="line">        .<span class="keyword">long</span>   <span class="number">3</span>                                                         |        .<span class="keyword">long</span>   <span class="number">3</span></span><br><span class="line">        .section        .rodata                                           |        .text</span><br><span class="line">.LC0:                                                                     |        .globl  _Z5funcci</span><br><span class="line">        .<span class="built_in">string</span> <span class="string">"hello"</span>                                                   |        .type   _Z5funcci, @function</span><br><span class="line">.LC1:                                                                     |_Z5funcci:</span><br><span class="line">        .<span class="built_in">string</span> <span class="string">"%d  %lx\n"</span>                                               |.LFB0:</span><br><span class="line">        .text                                                             |        .cfi_startproc</span><br><span class="line">        .globl  main                                                      |        pushq   %rbp</span><br><span class="line">        .type   main, @function                                           |        .cfi_def_cfa_offset <span class="number">16</span></span><br><span class="line">main:                                                                     |        .cfi_offset <span class="number">6</span>, <span class="number">-16</span></span><br><span class="line">.LFB2:                                                                    |        movq    %rsp, %rbp</span><br><span class="line">        .cfi_startproc                                                    |        .cfi_def_cfa_register <span class="number">6</span></span><br><span class="line">        pushq   %rbp                                                      |        movl    %edi, <span class="number">-20</span>(%rbp)</span><br><span class="line">        .cfi_def_cfa_offset <span class="number">16</span>                                            |        movl    <span class="number">-20</span>(%rbp), %eax</span><br><span class="line">        .cfi_offset <span class="number">6</span>, <span class="number">-16</span>                                                |        leal    <span class="number">3</span>(%rax), %edx</span><br><span class="line">        movq    %rsp, %rbp                                                |        movl    g_n(%rip), %eax</span><br><span class="line">        .cfi_def_cfa_register <span class="number">6</span>                                           |        addl    %edx, %eax</span><br><span class="line">        subq    $<span class="number">16</span>, %rsp                                                 |        movl    %eax, <span class="number">-4</span>(%rbp)</span><br><span class="line">        movl    $<span class="number">3</span>, <span class="number">-16</span>(%rbp)                                             |        movl    <span class="number">-4</span>(%rbp), %eax</span><br><span class="line">        movl    $.LC0, %edi                                               |        popq    %rbp</span><br><span class="line">        movl    $<span class="number">0</span>, %eax                                                  |        .cfi_def_cfa <span class="number">7</span>, <span class="number">8</span></span><br><span class="line">        call    <span class="built_in">printf</span>                                                    |        ret</span><br><span class="line">        movl    $<span class="number">234323</span>, %edi                                             |        .cfi_endproc</span><br><span class="line">        call    setuid                                                    |.LFE0:</span><br><span class="line">        movl    <span class="number">-16</span>(%rbp), %eax                                           |        .size   _Z5funcci, .-_Z5funcci</span><br><span class="line">        addl    $<span class="number">2</span>, %eax                                                  |        .ident  <span class="string">"GCC: (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4"</span></span><br><span class="line">        movl    %eax, %edi                                                |        .section        .note.GNU-<span class="built_in">stack</span>,<span class="string">""</span>,@progbits</span><br><span class="line">        call    _Z5funcci                                                  </span><br><span class="line">        movl    %eax, <span class="number">-12</span>(%rbp)                                           </span><br><span class="line">        movl    $<span class="number">8</span>, %eax</span><br><span class="line">        movq    %rax, %rdi                                                </span><br><span class="line">        call    <span class="built_in">malloc</span></span><br><span class="line">        movq    %rax, <span class="number">-8</span>(%rbp)                                            </span><br><span class="line">        movq    <span class="number">-8</span>(%rbp), %rax                                            </span><br><span class="line">        movl    $<span class="number">2</span>, (%rax)</span><br><span class="line">        movq    <span class="number">-8</span>(%rbp), %rax                                            </span><br><span class="line">        movl    (%rax), %eax</span><br><span class="line">        movq    <span class="number">-8</span>(%rbp), %rdx                                            </span><br><span class="line">        movl    %eax, %esi</span><br><span class="line">        movl    $.LC1, %edi                                               </span><br><span class="line">        movl    $<span class="number">0</span>, %eax                                                  </span><br><span class="line">        call    <span class="built_in">printf</span></span><br><span class="line">        movq    <span class="number">-8</span>(%rbp), %rax                                            </span><br><span class="line">        movq    %rax, %rdi                                                </span><br><span class="line">        call    <span class="built_in">free</span></span><br><span class="line">        movl    $<span class="number">0</span>, %eax                                                  </span><br><span class="line">        leave</span><br><span class="line">        .cfi_def_cfa <span class="number">7</span>, <span class="number">8</span>                                                 </span><br><span class="line">        ret</span><br><span class="line">        .cfi_endproc                                                      </span><br><span class="line">.LFE2:  </span><br><span class="line">        .size   main, .-main</span><br><span class="line">        .ident  <span class="string">"GCC: (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4"</span>              </span><br><span class="line">        .section        .note.GNU-<span class="built_in">stack</span>,<span class="string">""</span>,@progbits</span><br></pre></td></tr></table></figure></p>
<h4 id="编译为目标文件："><a href="#编译为目标文件：" class="headerlink" title="编译为目标文件："></a>编译为目标文件：</h4><p>gcc -c main.cpp<br>gcc -c func.cpp<br>objdump -x func.o<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br></pre></td><td class="code"><pre><span class="line"> file func.o</span><br><span class="line">func.o: ELF <span class="number">64</span>-bit LSB  relocatable, x86<span class="number">-64</span>, version <span class="number">1</span> (SYSV), <span class="keyword">not</span> stripped</span><br><span class="line">为relocatable可重定向文件</span><br><span class="line">objdump  -x func.o</span><br><span class="line"></span><br><span class="line">func.o:     file format elf64-x86<span class="number">-64</span> 文件格式</span><br><span class="line">func.o</span><br><span class="line">architecture: i386:x86<span class="number">-64</span>, flags <span class="number">0x00000011</span>: 系统架构</span><br><span class="line">HAS_RELOC, HAS_SYMS</span><br><span class="line">start address <span class="number">0x0000000000000000</span></span><br><span class="line"></span><br><span class="line">Sections:</span><br><span class="line">Idx Name          Size      VMA               LMA               File off  Algn</span><br><span class="line">  <span class="number">0</span> .text         <span class="number">0000001</span>d  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000040</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE</span><br><span class="line">  <span class="number">1</span> .data         <span class="number">00000004</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000060</span>  <span class="number">2</span>**<span class="number">2</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, DATA</span><br><span class="line">  <span class="number">2</span> .bss          <span class="number">00000000</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000064</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  ALLOC</span><br><span class="line">  <span class="number">3</span> .comment      <span class="number">0000002</span>c  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000064</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, READONLY</span><br><span class="line">  <span class="number">4</span> .note.GNU-<span class="built_in">stack</span> <span class="number">00000000</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000090</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, READONLY</span><br><span class="line">  <span class="number">5</span> .eh_frame     <span class="number">00000038</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000090</span>  <span class="number">2</span>**<span class="number">3</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, DATA</span><br><span class="line">SYMBOL TABLE:符号表，每个编译后的目标文件都有</span><br><span class="line"><span class="number">0000000000000000</span> l    df *ABS*	<span class="number">0000000000000000</span> func.cpp</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .text	<span class="number">0000000000000000</span> .text</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .data	<span class="number">0000000000000000</span> .data</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .bss	<span class="number">0000000000000000</span> .bss</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .note.GNU-<span class="built_in">stack</span>	<span class="number">0000000000000000</span> .note.GNU-<span class="built_in">stack</span></span><br><span class="line"><span class="number">0000000000000000</span> l    d  .eh_frame	<span class="number">0000000000000000</span> .eh_frame</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .comment	<span class="number">0000000000000000</span> .comment</span><br><span class="line"><span class="number">0000000000000000</span> g     O .data	<span class="number">0000000000000004</span> g_m</span><br><span class="line"><span class="number">0000000000000000</span> g     F .text	<span class="number">000000000000001</span>d _Z5funcci</span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> g_n  <span class="comment">//依赖的外部，未定义的符号</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.text]:</span><br><span class="line">OFFSET           TYPE              VALUE </span><br><span class="line"><span class="number">000000000000000f</span> R_X86_64_PC32     g_n<span class="number">-0x0000000000000004</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.eh_frame]:</span><br><span class="line">OFFSET           TYPE              VALUE </span><br><span class="line"><span class="number">0000000000000020</span> R_X86_64_PC32     .text</span><br><span class="line"></span><br><span class="line">  file main.o</span><br><span class="line">main.o: ELF <span class="number">64</span>-bit LSB  relocatable, x86<span class="number">-64</span>, version <span class="number">1</span> (SYSV), <span class="keyword">not</span> stripped</span><br><span class="line"> objdump  -x main.o</span><br><span class="line"></span><br><span class="line">main.o:     file format elf64-x86<span class="number">-64</span></span><br><span class="line">main.o</span><br><span class="line">architecture: i386:x86<span class="number">-64</span>, flags <span class="number">0x00000011</span>:</span><br><span class="line">HAS_RELOC, HAS_SYMS</span><br><span class="line">start address <span class="number">0x0000000000000000</span></span><br><span class="line"></span><br><span class="line">Sections:</span><br><span class="line">Idx Name          Size      VMA               LMA               File off  Algn</span><br><span class="line">  <span class="number">0</span> .text         <span class="number">00000081</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000040</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, CODE</span><br><span class="line">  <span class="number">1</span> .data         <span class="number">00000004</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">000000</span>c4  <span class="number">2</span>**<span class="number">2</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, DATA</span><br><span class="line">  <span class="number">2</span> .bss          <span class="number">00000000</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">000000</span>c8  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  ALLOC</span><br><span class="line">  <span class="number">3</span> .rodata       <span class="number">0000000f</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">000000</span>c8  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, READONLY, DATA</span><br><span class="line">  <span class="number">4</span> .comment      <span class="number">0000002</span>c  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">000000</span>d7  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, READONLY</span><br><span class="line">  <span class="number">5</span> .note.GNU-<span class="built_in">stack</span> <span class="number">00000000</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000103</span>  <span class="number">2</span>**<span class="number">0</span></span><br><span class="line">                  CONTENTS, READONLY</span><br><span class="line">  <span class="number">6</span> .eh_frame     <span class="number">00000038</span>  <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>  <span class="number">00000108</span>  <span class="number">2</span>**<span class="number">3</span></span><br><span class="line">                  CONTENTS, ALLOC, LOAD, RELOC, READONLY, DATA</span><br><span class="line">SYMBOL TABLE: 这个是符号表，即这个文件导出或者依赖的符号，用于模块间调用使用；</span><br><span class="line"><span class="number">0000000000000000</span> l    df *ABS*	<span class="number">0000000000000000</span> main.cpp</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .text	<span class="number">0000000000000000</span> .text</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .data	<span class="number">0000000000000000</span> .data</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .bss	<span class="number">0000000000000000</span> .bss</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .rodata	<span class="number">0000000000000000</span> .rodata</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .note.GNU-<span class="built_in">stack</span>	<span class="number">0000000000000000</span> .note.GNU-<span class="built_in">stack</span></span><br><span class="line"><span class="number">0000000000000000</span> l    d  .eh_frame	<span class="number">0000000000000000</span> .eh_frame</span><br><span class="line"><span class="number">0000000000000000</span> l    d  .comment	<span class="number">0000000000000000</span> .comment</span><br><span class="line"><span class="number">0000000000000000</span> g     O .data	<span class="number">0000000000000004</span> g_n</span><br><span class="line"><span class="number">0000000000000000</span> g     F .text	<span class="number">0000000000000081</span> main <span class="comment">//下面为依赖的外部符号，有点多，可以看到，因为这里没有使用g_m，所以不依赖；</span></span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> <span class="built_in">printf</span></span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> setuid</span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> _Z5funcci</span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> <span class="built_in">malloc</span></span><br><span class="line"><span class="number">0000000000000000</span>         *UND*	<span class="number">0000000000000000</span> <span class="built_in">free</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.text]:</span><br><span class="line">OFFSET           TYPE              VALUE </span><br><span class="line"><span class="number">0000000000000010</span> R_X86_64_32       .rodata</span><br><span class="line"><span class="number">000000000000001</span>a R_X86_64_PC32     <span class="built_in">printf</span><span class="number">-0x0000000000000004</span></span><br><span class="line"><span class="number">0000000000000024</span> R_X86_64_PC32     setuid<span class="number">-0x0000000000000004</span></span><br><span class="line"><span class="number">0000000000000031</span> R_X86_64_PC32     _Z5funcci<span class="number">-0x0000000000000004</span></span><br><span class="line"><span class="number">0000000000000041</span> R_X86_64_PC32     <span class="built_in">malloc</span><span class="number">-0x0000000000000004</span></span><br><span class="line"><span class="number">0000000000000060</span> R_X86_64_32       .rodata+<span class="number">0x0000000000000006</span></span><br><span class="line"><span class="number">000000000000006</span>a R_X86_64_PC32     <span class="built_in">printf</span><span class="number">-0x0000000000000004</span></span><br><span class="line"><span class="number">0000000000000076</span> R_X86_64_PC32     <span class="built_in">free</span><span class="number">-0x0000000000000004</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">RELOCATION RECORDS FOR [.eh_frame]:</span><br><span class="line">OFFSET           TYPE              VALUE </span><br><span class="line"><span class="number">0000000000000020</span> R_X86_64_PC32     .text</span><br></pre></td></tr></table></figure></p>
<h4 id="接下来链接："><a href="#接下来链接：" class="headerlink" title="接下来链接："></a>接下来链接：</h4><p>gcc -o main main.cpp  func.cpp<br>也可以用ld命令链接，但是需要指定更多依赖；而gcc会自己去寻找一些默认的库等；</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> file main</span><br><span class="line">main: ELF 64-bit LSB  executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for GNU/Linux 2.6.24, BuildID[sha1]=2110927a3d6ecf4dd0f70085d18bc49c3b61ba41, not stripped</span><br></pre></td></tr></table></figure>
<p>可以看到这个文件为可执行文件类型；<br>通过elf工具看整个可执行程序的结构：上面的main.o func.o也是elf文件类型之一<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br></pre></td><td class="code"><pre><span class="line"> readelf -a main</span><br><span class="line"> elf文件头：各个字段</span><br><span class="line">ELF Header:</span><br><span class="line">  Magic:   <span class="number">7f</span> <span class="number">45</span> <span class="number">4</span>c <span class="number">46</span> <span class="number">02</span> <span class="number">01</span> <span class="number">01</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> <span class="number">00</span> </span><br><span class="line">  Class:                             ELF64</span><br><span class="line">  Data:                              <span class="number">2'</span>s complement, little endian</span><br><span class="line">  Version:                           <span class="number">1</span> (current)</span><br><span class="line">  OS/ABI:                            UNIX - System V</span><br><span class="line">  ABI Version:                       <span class="number">0</span></span><br><span class="line">  Type:                              EXEC (Executable file)</span><br><span class="line">  Machine:                           Advanced Micro Devices X86<span class="number">-64</span></span><br><span class="line">  Version:                           <span class="number">0x1</span></span><br><span class="line">  Entry point address:               <span class="number">0x400520</span></span><br><span class="line">  Start of program headers:          <span class="number">64</span> (bytes into file)</span><br><span class="line">  Start of section headers:          <span class="number">4544</span> (bytes into file)</span><br><span class="line">  Flags:                             <span class="number">0x0</span></span><br><span class="line">  Size of <span class="keyword">this</span> header:               <span class="number">64</span> (bytes)</span><br><span class="line">  Size of program headers:           <span class="number">56</span> (bytes)</span><br><span class="line">  Number of program headers:         <span class="number">9</span></span><br><span class="line">  Size of section headers:           <span class="number">64</span> (bytes)</span><br><span class="line">  Number of section headers:         <span class="number">30</span></span><br><span class="line">  Section header <span class="built_in">string</span> table index: <span class="number">27</span></span><br><span class="line"></span><br><span class="line">各个sections</span><br><span class="line">Section Headers:</span><br><span class="line">  [Nr] Name              Type             Address           Offset</span><br><span class="line">       Size              EntSize          Flags  Link  Info  Align</span><br><span class="line">  [ <span class="number">0</span>]                   <span class="literal">NULL</span>             <span class="number">0000000000000000</span>  <span class="number">00000000</span></span><br><span class="line">       <span class="number">0000000000000000</span>  <span class="number">0000000000000000</span>           <span class="number">0</span>     <span class="number">0</span>     <span class="number">0</span></span><br><span class="line">  [ <span class="number">1</span>] .interp           PROGBITS         <span class="number">0000000000400238</span>  <span class="number">00000238</span></span><br><span class="line">       <span class="number">000000000000001</span>c  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">  [ <span class="number">2</span>] .note.ABI-tag     NOTE             <span class="number">0000000000400254</span>  <span class="number">00000254</span></span><br><span class="line">       <span class="number">0000000000000020</span>  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [ <span class="number">3</span>] .note.gnu.build-i NOTE             <span class="number">0000000000400274</span>  <span class="number">00000274</span></span><br><span class="line">       <span class="number">0000000000000024</span>  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [ <span class="number">4</span>] .gnu.hash         GNU_HASH         <span class="number">0000000000400298</span>  <span class="number">00000298</span></span><br><span class="line">       <span class="number">000000000000001</span>c  <span class="number">0000000000000000</span>   A       <span class="number">5</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [ <span class="number">5</span>] .dynsym           DYNSYM           <span class="number">00000000004002b</span>8  <span class="number">000002b</span>8</span><br><span class="line">       <span class="number">00000000000000</span>a8  <span class="number">0000000000000018</span>   A       <span class="number">6</span>     <span class="number">1</span>     <span class="number">8</span></span><br><span class="line">  [ <span class="number">6</span>] .dynstr           STRTAB           <span class="number">0000000000400360</span>  <span class="number">00000360</span></span><br><span class="line">       <span class="number">0000000000000052</span>  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">  [ <span class="number">7</span>] .gnu.version      VERSYM           <span class="number">00000000004003b</span>2  <span class="number">000003b</span>2</span><br><span class="line">       <span class="number">000000000000000</span>e  <span class="number">0000000000000002</span>   A       <span class="number">5</span>     <span class="number">0</span>     <span class="number">2</span></span><br><span class="line">  [ <span class="number">8</span>] .gnu.version_r    VERNEED          <span class="number">00000000004003</span>c0  <span class="number">000003</span>c0</span><br><span class="line">       <span class="number">0000000000000020</span>  <span class="number">0000000000000000</span>   A       <span class="number">6</span>     <span class="number">1</span>     <span class="number">8</span></span><br><span class="line">  [ <span class="number">9</span>] .rela.dyn         RELA             <span class="number">00000000004003e0</span>  <span class="number">000003e0</span></span><br><span class="line">       <span class="number">0000000000000018</span>  <span class="number">0000000000000018</span>   A       <span class="number">5</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">10</span>] .rela.plt         RELA             <span class="number">00000000004003f</span>8  <span class="number">000003f</span>8</span><br><span class="line">       <span class="number">0000000000000090</span>  <span class="number">0000000000000018</span>   A       <span class="number">5</span>    <span class="number">12</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">11</span>] .init             PROGBITS         <span class="number">0000000000400488</span>  <span class="number">00000488</span></span><br><span class="line">       <span class="number">000000000000001</span>a  <span class="number">0000000000000000</span>  AX       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [<span class="number">12</span>] .plt              PROGBITS         <span class="number">00000000004004b</span>0  <span class="number">000004b</span>0</span><br><span class="line">       <span class="number">0000000000000070</span>  <span class="number">0000000000000010</span>  AX       <span class="number">0</span>     <span class="number">0</span>     <span class="number">16</span></span><br><span class="line">  [<span class="number">13</span>] .text             PROGBITS         <span class="number">0000000000400520</span>  <span class="number">00000520</span></span><br><span class="line">       <span class="number">0000000000000202</span>  <span class="number">0000000000000000</span>  AX       <span class="number">0</span>     <span class="number">0</span>     <span class="number">16</span></span><br><span class="line">  [<span class="number">14</span>] .fini             PROGBITS         <span class="number">0000000000400724</span>  <span class="number">00000724</span></span><br><span class="line">       <span class="number">0000000000000009</span>  <span class="number">0000000000000000</span>  AX       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [<span class="number">15</span>] .rodata           PROGBITS         <span class="number">0000000000400730</span>  <span class="number">00000730</span></span><br><span class="line">       <span class="number">0000000000000013</span>  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [<span class="number">16</span>] .eh_frame_hdr     PROGBITS         <span class="number">0000000000400744</span>  <span class="number">00000744</span></span><br><span class="line">       <span class="number">000000000000003</span>c  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">4</span></span><br><span class="line">  [<span class="number">17</span>] .eh_frame         PROGBITS         <span class="number">0000000000400780</span>  <span class="number">00000780</span></span><br><span class="line">       <span class="number">0000000000000114</span>  <span class="number">0000000000000000</span>   A       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">18</span>] .init_array       INIT_ARRAY       <span class="number">0000000000600e10</span>  <span class="number">00000e10</span></span><br><span class="line">       <span class="number">0000000000000008</span>  <span class="number">0000000000000000</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">19</span>] .fini_array       FINI_ARRAY       <span class="number">0000000000600e18</span>  <span class="number">00000e18</span></span><br><span class="line">       <span class="number">0000000000000008</span>  <span class="number">0000000000000000</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">20</span>] .jcr              PROGBITS         <span class="number">0000000000600e20</span>  <span class="number">00000e20</span></span><br><span class="line">       <span class="number">0000000000000008</span>  <span class="number">0000000000000000</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">21</span>] .dynamic          DYNAMIC          <span class="number">0000000000600e28</span>  <span class="number">00000e28</span></span><br><span class="line">       <span class="number">00000000000001</span>d0  <span class="number">0000000000000010</span>  WA       <span class="number">6</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">22</span>] .got              PROGBITS         <span class="number">0000000000600f</span>f8  <span class="number">00000f</span>f8</span><br><span class="line">       <span class="number">0000000000000008</span>  <span class="number">0000000000000008</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">23</span>] .got.plt          PROGBITS         <span class="number">0000000000601000</span>  <span class="number">00001000</span></span><br><span class="line">       <span class="number">0000000000000048</span>  <span class="number">0000000000000008</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">24</span>] .data             PROGBITS         <span class="number">0000000000601048</span>  <span class="number">00001048</span></span><br><span class="line">       <span class="number">0000000000000018</span>  <span class="number">0000000000000000</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">25</span>] .bss              NOBITS           <span class="number">0000000000601060</span>  <span class="number">00001060</span></span><br><span class="line">       <span class="number">0000000000000008</span>  <span class="number">0000000000000000</span>  WA       <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">  [<span class="number">26</span>] .comment          PROGBITS         <span class="number">0000000000000000</span>  <span class="number">00001060</span></span><br><span class="line">       <span class="number">0000000000000056</span>  <span class="number">0000000000000001</span>  MS       <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">  [<span class="number">27</span>] .shstrtab         STRTAB           <span class="number">0000000000000000</span>  <span class="number">000010b</span>6</span><br><span class="line">       <span class="number">0000000000000108</span>  <span class="number">0000000000000000</span>           <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">  [<span class="number">28</span>] .symtab           SYMTAB           <span class="number">0000000000000000</span>  <span class="number">00001940</span></span><br><span class="line">       <span class="number">00000000000006</span>c0  <span class="number">0000000000000018</span>          <span class="number">29</span>    <span class="number">46</span>     <span class="number">8</span></span><br><span class="line">  [<span class="number">29</span>] .strtab           STRTAB           <span class="number">0000000000000000</span>  <span class="number">00002000</span></span><br><span class="line">       <span class="number">000000000000028f</span>  <span class="number">0000000000000000</span>           <span class="number">0</span>     <span class="number">0</span>     <span class="number">1</span></span><br><span class="line">Key to Flags:</span><br><span class="line">  W (write), A (alloc), X (execute), M (merge), S (strings), l (large)</span><br><span class="line">  I (info), L (link order), G (group), T (TLS), E (exclude), x (unknown)</span><br><span class="line">  O (extra OS processing required) o (OS specific), p (processor specific)</span><br><span class="line"></span><br><span class="line">There are no section groups in <span class="keyword">this</span> file.</span><br><span class="line"></span><br><span class="line">Program Headers:</span><br><span class="line">  Type           Offset             VirtAddr           PhysAddr</span><br><span class="line">                 FileSiz            MemSiz              Flags  Align</span><br><span class="line">  PHDR           <span class="number">0x0000000000000040</span> <span class="number">0x0000000000400040</span> <span class="number">0x0000000000400040</span></span><br><span class="line">                 <span class="number">0x00000000000001f8</span> <span class="number">0x00000000000001f8</span>  R E    <span class="number">8</span></span><br><span class="line">  INTERP         <span class="number">0x0000000000000238</span> <span class="number">0x0000000000400238</span> <span class="number">0x0000000000400238</span></span><br><span class="line">                 <span class="number">0x000000000000001c</span> <span class="number">0x000000000000001c</span>  R      <span class="number">1</span></span><br><span class="line">      [Requesting program interpreter: /lib64/ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span>]</span><br><span class="line">  LOAD           <span class="number">0x0000000000000000</span> <span class="number">0x0000000000400000</span> <span class="number">0x0000000000400000</span></span><br><span class="line">                 <span class="number">0x0000000000000894</span> <span class="number">0x0000000000000894</span>  R E    <span class="number">200000</span></span><br><span class="line">  LOAD           <span class="number">0x0000000000000e10</span> <span class="number">0x0000000000600e10</span> <span class="number">0x0000000000600e10</span></span><br><span class="line">                 <span class="number">0x0000000000000250</span> <span class="number">0x0000000000000258</span>  RW     <span class="number">200000</span></span><br><span class="line">  DYNAMIC        <span class="number">0x0000000000000e28</span> <span class="number">0x0000000000600e28</span> <span class="number">0x0000000000600e28</span></span><br><span class="line">                 <span class="number">0x00000000000001d0</span> <span class="number">0x00000000000001d0</span>  RW     <span class="number">8</span></span><br><span class="line">  NOTE           <span class="number">0x0000000000000254</span> <span class="number">0x0000000000400254</span> <span class="number">0x0000000000400254</span></span><br><span class="line">                 <span class="number">0x0000000000000044</span> <span class="number">0x0000000000000044</span>  R      <span class="number">4</span></span><br><span class="line">  GNU_EH_FRAME   <span class="number">0x0000000000000744</span> <span class="number">0x0000000000400744</span> <span class="number">0x0000000000400744</span></span><br><span class="line">                 <span class="number">0x000000000000003c</span> <span class="number">0x000000000000003c</span>  R      <span class="number">4</span></span><br><span class="line">  GNU_STACK      <span class="number">0x0000000000000000</span> <span class="number">0x0000000000000000</span> <span class="number">0x0000000000000000</span></span><br><span class="line">                 <span class="number">0x0000000000000000</span> <span class="number">0x0000000000000000</span>  RW     <span class="number">10</span></span><br><span class="line">  GNU_RELRO      <span class="number">0x0000000000000e10</span> <span class="number">0x0000000000600e10</span> <span class="number">0x0000000000600e10</span></span><br><span class="line">                 <span class="number">0x00000000000001f0</span> <span class="number">0x00000000000001f0</span>  R      <span class="number">1</span></span><br><span class="line"></span><br><span class="line"> Section to Segment mapping:</span><br><span class="line">  Segment Sections...</span><br><span class="line">   <span class="number">00</span>     </span><br><span class="line">   <span class="number">01</span>     .interp </span><br><span class="line">   <span class="number">02</span>     .interp .note.ABI-tag .note.gnu.build-id .gnu.hash .dynsym .dynstr .gnu.version .gnu.version_r .rela.dyn .rela.plt .init .plt .text .fini .rodata .eh_frame_hdr .eh_frame </span><br><span class="line">   <span class="number">03</span>     .init_array .fini_array .jcr .dynamic .got .got.plt .data .bss </span><br><span class="line">   <span class="number">04</span>     .dynamic </span><br><span class="line">   <span class="number">05</span>     .note.ABI-tag .note.gnu.build-id </span><br><span class="line">   <span class="number">06</span>     .eh_frame_hdr </span><br><span class="line">   <span class="number">07</span>     </span><br><span class="line">   <span class="number">08</span>     .init_array .fini_array .jcr .dynamic .got </span><br><span class="line"></span><br><span class="line">Dynamic section at offset <span class="number">0xe28</span> contains <span class="number">24</span> entries:</span><br><span class="line">  Tag        Type                         Name/Value</span><br><span class="line"> <span class="number">0x0000000000000001</span> (NEEDED)             Shared library: [libc.so<span class="number">.6</span>]</span><br><span class="line"> <span class="number">0x000000000000000c</span> (INIT)               <span class="number">0x400488</span></span><br><span class="line"> <span class="number">0x000000000000000d</span> (FINI)               <span class="number">0x400724</span></span><br><span class="line"> <span class="number">0x0000000000000019</span> (INIT_ARRAY)         <span class="number">0x600e10</span></span><br><span class="line"> <span class="number">0x000000000000001b</span> (INIT_ARRAYSZ)       <span class="number">8</span> (bytes)</span><br><span class="line"> <span class="number">0x000000000000001a</span> (FINI_ARRAY)         <span class="number">0x600e18</span></span><br><span class="line"> <span class="number">0x000000000000001c</span> (FINI_ARRAYSZ)       <span class="number">8</span> (bytes)</span><br><span class="line"> <span class="number">0x000000006ffffef5</span> (GNU_HASH)           <span class="number">0x400298</span></span><br><span class="line"> <span class="number">0x0000000000000005</span> (STRTAB)             <span class="number">0x400360</span></span><br><span class="line"> <span class="number">0x0000000000000006</span> (SYMTAB)             <span class="number">0x4002b8</span></span><br><span class="line"> <span class="number">0x000000000000000a</span> (STRSZ)              <span class="number">82</span> (bytes)</span><br><span class="line"> <span class="number">0x000000000000000b</span> (SYMENT)             <span class="number">24</span> (bytes)</span><br><span class="line"> <span class="number">0x0000000000000015</span> (DEBUG)              <span class="number">0x0</span></span><br><span class="line"> <span class="number">0x0000000000000003</span> (PLTGOT)             <span class="number">0x601000</span></span><br><span class="line"> <span class="number">0x0000000000000002</span> (PLTRELSZ)           <span class="number">144</span> (bytes)</span><br><span class="line"> <span class="number">0x0000000000000014</span> (PLTREL)             RELA</span><br><span class="line"> <span class="number">0x0000000000000017</span> (JMPREL)             <span class="number">0x4003f8</span></span><br><span class="line"> <span class="number">0x0000000000000007</span> (RELA)               <span class="number">0x4003e0</span></span><br><span class="line"> <span class="number">0x0000000000000008</span> (RELASZ)             <span class="number">24</span> (bytes)</span><br><span class="line"> <span class="number">0x0000000000000009</span> (RELAENT)            <span class="number">24</span> (bytes)</span><br><span class="line"> <span class="number">0x000000006ffffffe</span> (VERNEED)            <span class="number">0x4003c0</span></span><br><span class="line"> <span class="number">0x000000006fffffff</span> (VERNEEDNUM)         <span class="number">1</span></span><br><span class="line"> <span class="number">0x000000006ffffff0</span> (VERSYM)             <span class="number">0x4003b2</span></span><br><span class="line"> <span class="number">0x0000000000000000</span> (<span class="literal">NULL</span>)               <span class="number">0x0</span></span><br><span class="line"></span><br><span class="line">Relocation section '.rela.dyn' at offset 0x3e0 contains 1 entries:</span><br><span class="line">  Offset          Info           Type           Sym. Value    Sym. Name + Addend</span><br><span class="line"><span class="number">000000600f</span>f8  <span class="number">000400000006</span> R_X86_64_GLOB_DAT <span class="number">0000000000000000</span> __gmon_start__ + <span class="number">0</span></span><br><span class="line"></span><br><span class="line">Relocation section '.rela.plt' at offset 0x3f8 contains 6 entries:</span><br><span class="line">  Offset          Info           Type           Sym. Value    Sym. Name + Addend</span><br><span class="line"><span class="number">000000601018</span>  <span class="number">000100000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> <span class="built_in">free</span> + <span class="number">0</span></span><br><span class="line"><span class="number">000000601020</span>  <span class="number">000200000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> <span class="built_in">printf</span> + <span class="number">0</span></span><br><span class="line"><span class="number">000000601028</span>  <span class="number">000300000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> __libc_start_main + <span class="number">0</span></span><br><span class="line"><span class="number">000000601030</span>  <span class="number">000400000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> __gmon_start__ + <span class="number">0</span></span><br><span class="line"><span class="number">000000601038</span>  <span class="number">000500000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> <span class="built_in">malloc</span> + <span class="number">0</span></span><br><span class="line"><span class="number">000000601040</span>  <span class="number">000600000007</span> R_X86_64_JUMP_SLO <span class="number">0000000000000000</span> setuid + <span class="number">0</span></span><br><span class="line"></span><br><span class="line">The decoding of unwind sections <span class="keyword">for</span> machine type Advanced Micro Devices X86<span class="number">-64</span> is <span class="keyword">not</span> currently supported.</span><br><span class="line"></span><br><span class="line">Symbol table '.dynsym' contains 7 entries:</span><br><span class="line">   Num:    Value          Size Type    Bind   Vis      Ndx Name</span><br><span class="line">     <span class="number">0</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  LOCAL  DEFAULT  UND </span><br><span class="line">     <span class="number">1</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">free</span>@GLIBC_2<span class="number">.2</span><span class="number">.5</span> (<span class="number">2</span>)</span><br><span class="line">     <span class="number">2</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">printf</span>@GLIBC_2<span class="number">.2</span><span class="number">.5</span> (<span class="number">2</span>)</span><br><span class="line">     <span class="number">3</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND __libc_start_main@GLIBC_2<span class="number">.2</span><span class="number">.5</span> (<span class="number">2</span>)</span><br><span class="line">     <span class="number">4</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT  UND __gmon_start__</span><br><span class="line">     <span class="number">5</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">malloc</span>@GLIBC_2<span class="number">.2</span><span class="number">.5</span> (<span class="number">2</span>)</span><br><span class="line">     <span class="number">6</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND setuid@GLIBC_2<span class="number">.2</span><span class="number">.5</span> (<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">Symbol table '.symtab' contains 72 entries:</span><br><span class="line">   Num:    Value          Size Type    Bind   Vis      Ndx Name</span><br><span class="line">     <span class="number">0</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  LOCAL  DEFAULT  UND </span><br><span class="line">     <span class="number">1</span>: <span class="number">0000000000400238</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">1</span> </span><br><span class="line">     <span class="number">2</span>: <span class="number">0000000000400254</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">2</span> </span><br><span class="line">     <span class="number">3</span>: <span class="number">0000000000400274</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">3</span> </span><br><span class="line">     <span class="number">4</span>: <span class="number">0000000000400298</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">4</span> </span><br><span class="line">     <span class="number">5</span>: <span class="number">00000000004002b</span>8     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">5</span> </span><br><span class="line">     <span class="number">6</span>: <span class="number">0000000000400360</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">6</span> </span><br><span class="line">     <span class="number">7</span>: <span class="number">00000000004003b</span>2     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">7</span> </span><br><span class="line">     <span class="number">8</span>: <span class="number">00000000004003</span>c0     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">8</span> </span><br><span class="line">     <span class="number">9</span>: <span class="number">00000000004003e0</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT    <span class="number">9</span> </span><br><span class="line">    <span class="number">10</span>: <span class="number">00000000004003f</span>8     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">10</span> </span><br><span class="line">    <span class="number">11</span>: <span class="number">0000000000400488</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">11</span> </span><br><span class="line">    <span class="number">12</span>: <span class="number">00000000004004b</span>0     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">12</span> </span><br><span class="line">    <span class="number">13</span>: <span class="number">0000000000400520</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">13</span> </span><br><span class="line">    <span class="number">14</span>: <span class="number">0000000000400724</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">14</span> </span><br><span class="line">    <span class="number">15</span>: <span class="number">0000000000400730</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">15</span> </span><br><span class="line">    <span class="number">16</span>: <span class="number">0000000000400744</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">16</span> </span><br><span class="line">    <span class="number">17</span>: <span class="number">0000000000400780</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">17</span> </span><br><span class="line">    <span class="number">18</span>: <span class="number">0000000000600e10</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">18</span> </span><br><span class="line">    <span class="number">19</span>: <span class="number">0000000000600e18</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">19</span> </span><br><span class="line">    <span class="number">20</span>: <span class="number">0000000000600e20</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">20</span> </span><br><span class="line">    <span class="number">21</span>: <span class="number">0000000000600e28</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">21</span> </span><br><span class="line">    <span class="number">22</span>: <span class="number">0000000000600f</span>f8     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">22</span> </span><br><span class="line">    <span class="number">23</span>: <span class="number">0000000000601000</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">23</span> </span><br><span class="line">    <span class="number">24</span>: <span class="number">0000000000601048</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">24</span> </span><br><span class="line">    <span class="number">25</span>: <span class="number">0000000000601060</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">25</span> </span><br><span class="line">    <span class="number">26</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> SECTION LOCAL  DEFAULT   <span class="number">26</span> </span><br><span class="line">    <span class="number">27</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FILE    LOCAL  DEFAULT  ABS crtstuff.c</span><br><span class="line">    <span class="number">28</span>: <span class="number">0000000000600e20</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">20</span> __JCR_LIST__</span><br><span class="line">    <span class="number">29</span>: <span class="number">0000000000400550</span>     <span class="number">0</span> FUNC    LOCAL  DEFAULT   <span class="number">13</span> deregister_tm_clones</span><br><span class="line">    <span class="number">30</span>: <span class="number">0000000000400580</span>     <span class="number">0</span> FUNC    LOCAL  DEFAULT   <span class="number">13</span> register_tm_clones</span><br><span class="line">    <span class="number">31</span>: <span class="number">00000000004005</span>c0     <span class="number">0</span> FUNC    LOCAL  DEFAULT   <span class="number">13</span> __do_global_dtors_aux</span><br><span class="line">    <span class="number">32</span>: <span class="number">0000000000601060</span>     <span class="number">1</span> OBJECT  LOCAL  DEFAULT   <span class="number">25</span> completed<span class="number">.6982</span></span><br><span class="line">    <span class="number">33</span>: <span class="number">0000000000600e18</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">19</span> __do_global_dtors_aux_fin</span><br><span class="line">    <span class="number">34</span>: <span class="number">00000000004005e0</span>     <span class="number">0</span> FUNC    LOCAL  DEFAULT   <span class="number">13</span> frame_dummy</span><br><span class="line">    <span class="number">35</span>: <span class="number">0000000000600e10</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">18</span> __frame_dummy_init_array_</span><br><span class="line">    <span class="number">36</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FILE    LOCAL  DEFAULT  ABS main.cpp</span><br><span class="line">    <span class="number">37</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FILE    LOCAL  DEFAULT  ABS func.cpp</span><br><span class="line">    <span class="number">38</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FILE    LOCAL  DEFAULT  ABS crtstuff.c</span><br><span class="line">    <span class="number">39</span>: <span class="number">0000000000400890</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">17</span> __FRAME_END__</span><br><span class="line">    <span class="number">40</span>: <span class="number">0000000000600e20</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">20</span> __JCR_END__</span><br><span class="line">    <span class="number">41</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FILE    LOCAL  DEFAULT  ABS </span><br><span class="line">    <span class="number">42</span>: <span class="number">0000000000600e18</span>     <span class="number">0</span> NOTYPE  LOCAL  DEFAULT   <span class="number">18</span> __init_array_end</span><br><span class="line">    <span class="number">43</span>: <span class="number">0000000000600e28</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">21</span> _DYNAMIC</span><br><span class="line">    <span class="number">44</span>: <span class="number">0000000000600e10</span>     <span class="number">0</span> NOTYPE  LOCAL  DEFAULT   <span class="number">18</span> __init_array_start</span><br><span class="line">    <span class="number">45</span>: <span class="number">0000000000601000</span>     <span class="number">0</span> OBJECT  LOCAL  DEFAULT   <span class="number">23</span> _GLOBAL_OFFSET_TABLE_</span><br><span class="line">    <span class="number">46</span>: <span class="number">0000000000400720</span>     <span class="number">2</span> FUNC    GLOBAL DEFAULT   <span class="number">13</span> __libc_csu_fini</span><br><span class="line">    <span class="number">47</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">free</span>@@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">    <span class="number">48</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_deregisterTMCloneTab</span><br><span class="line">    <span class="number">49</span>: <span class="number">0000000000601048</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT   <span class="number">24</span> data_start</span><br><span class="line">    <span class="number">50</span>: <span class="number">000000000040068</span>e    <span class="number">29</span> FUNC    GLOBAL DEFAULT   <span class="number">13</span> _Z5funcci</span><br><span class="line">    <span class="number">51</span>: <span class="number">0000000000601060</span>     <span class="number">0</span> NOTYPE  GLOBAL DEFAULT   <span class="number">24</span> _edata</span><br><span class="line">    <span class="number">52</span>: <span class="number">0000000000400724</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT   <span class="number">14</span> _fini</span><br><span class="line">    <span class="number">53</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">printf</span>@@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">    <span class="number">54</span>: <span class="number">0000000000601058</span>     <span class="number">4</span> OBJECT  GLOBAL DEFAULT   <span class="number">24</span> g_n</span><br><span class="line">    <span class="number">55</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND __libc_start_main@@GLIBC_</span><br><span class="line">    <span class="number">56</span>: <span class="number">0000000000601048</span>     <span class="number">0</span> NOTYPE  GLOBAL DEFAULT   <span class="number">24</span> __data_start</span><br><span class="line">    <span class="number">57</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT  UND __gmon_start__</span><br><span class="line">    <span class="number">58</span>: <span class="number">0000000000601050</span>     <span class="number">0</span> OBJECT  GLOBAL HIDDEN    <span class="number">24</span> __dso_handle</span><br><span class="line">    <span class="number">59</span>: <span class="number">0000000000400730</span>     <span class="number">4</span> OBJECT  GLOBAL DEFAULT   <span class="number">15</span> _IO_stdin_used</span><br><span class="line">    <span class="number">60</span>: <span class="number">00000000004006b</span>0   <span class="number">101</span> FUNC    GLOBAL DEFAULT   <span class="number">13</span> __libc_csu_init</span><br><span class="line">    <span class="number">61</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND <span class="built_in">malloc</span>@@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">    <span class="number">62</span>: <span class="number">0000000000601068</span>     <span class="number">0</span> NOTYPE  GLOBAL DEFAULT   <span class="number">25</span> _end</span><br><span class="line">    <span class="number">63</span>: <span class="number">0000000000400520</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT   <span class="number">13</span> _start</span><br><span class="line">    <span class="number">64</span>: <span class="number">0000000000601060</span>     <span class="number">0</span> NOTYPE  GLOBAL DEFAULT   <span class="number">25</span> __bss_start</span><br><span class="line">    <span class="number">65</span>: <span class="number">000000000040060</span>d   <span class="number">129</span> FUNC    GLOBAL DEFAULT   <span class="number">13</span> main</span><br><span class="line">    <span class="number">66</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT  UND _Jv_RegisterClasses</span><br><span class="line">    <span class="number">67</span>: <span class="number">000000000060105</span>c     <span class="number">4</span> OBJECT  GLOBAL DEFAULT   <span class="number">24</span> g_m</span><br><span class="line">    <span class="number">68</span>: <span class="number">0000000000601060</span>     <span class="number">0</span> OBJECT  GLOBAL HIDDEN    <span class="number">24</span> __TMC_END__</span><br><span class="line">    <span class="number">69</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> NOTYPE  WEAK   DEFAULT  UND _ITM_registerTMCloneTable</span><br><span class="line">    <span class="number">70</span>: <span class="number">0000000000000000</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT  UND setuid@@GLIBC_2<span class="number">.2</span><span class="number">.5</span></span><br><span class="line">    <span class="number">71</span>: <span class="number">0000000000400488</span>     <span class="number">0</span> FUNC    GLOBAL DEFAULT   <span class="number">11</span> _init</span><br><span class="line"></span><br><span class="line">Version symbols section '.gnu.version' contains 7 entries:</span><br><span class="line"> Addr: <span class="number">00000000004003b</span>2  Offset: <span class="number">0x0003b2</span>  Link: <span class="number">5</span> (.dynsym)</span><br><span class="line">  <span class="number">000</span>:   <span class="number">0</span> (*local*)       <span class="number">2</span> (GLIBC_2<span class="number">.2</span><span class="number">.5</span>)   <span class="number">2</span> (GLIBC_2<span class="number">.2</span><span class="number">.5</span>)   <span class="number">2</span> (GLIBC_2<span class="number">.2</span><span class="number">.5</span>)</span><br><span class="line">  <span class="number">004</span>:   <span class="number">0</span> (*local*)       <span class="number">2</span> (GLIBC_2<span class="number">.2</span><span class="number">.5</span>)   <span class="number">2</span> (GLIBC_2<span class="number">.2</span><span class="number">.5</span>)</span><br><span class="line"></span><br><span class="line">Version needs section '.gnu.version_r' contains 1 entries:</span><br><span class="line"> Addr: <span class="number">0x00000000004003c0</span>  Offset: <span class="number">0x0003c0</span>  Link: <span class="number">6</span> (.dynstr)</span><br><span class="line">  <span class="number">000000</span>: Version: <span class="number">1</span>  File: libc.so<span class="number">.6</span>  Cnt: <span class="number">1</span></span><br><span class="line">  <span class="number">0x0010</span>:   Name: GLIBC_2<span class="number">.2</span><span class="number">.5</span>  Flags: none  Version: <span class="number">2</span></span><br><span class="line"></span><br><span class="line">Displaying notes found at file offset <span class="number">0x00000254</span> with length <span class="number">0x00000020</span>:</span><br><span class="line">  Owner                 Data size	Description</span><br><span class="line">  GNU                  <span class="number">0x00000010</span>	NT_GNU_ABI_TAG (ABI version tag)</span><br><span class="line">    OS: Linux, ABI: <span class="number">2.6</span><span class="number">.24</span></span><br><span class="line"></span><br><span class="line">Displaying notes found at file offset <span class="number">0x00000274</span> with length <span class="number">0x00000024</span>:</span><br><span class="line">  Owner                 Data size	Description</span><br><span class="line">  GNU                  <span class="number">0x00000014</span>	NT_GNU_BUILD_ID (unique build ID bitstring)</span><br><span class="line">    Build ID: <span class="number">2110927</span>a3d6ecf4dd0f70085d18bc49c3b61ba41</span><br></pre></td></tr></table></figure></p>
<h4 id="接着来追踪下程序的运行："><a href="#接着来追踪下程序的运行：" class="headerlink" title="接着来追踪下程序的运行："></a>接着来追踪下程序的运行：</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> ./main </span><br><span class="line">hello2  a61010</span><br><span class="line">think@think-VirtualBox:~/c++/testld$ strace ./main </span><br><span class="line">execve(<span class="string">"./main"</span>, [<span class="string">"./main"</span>], [<span class="comment">/* 74 vars */</span>]) = <span class="number">0</span></span><br><span class="line">brk(<span class="number">0</span>)                                  = <span class="number">0x9ba000</span></span><br><span class="line">access(<span class="string">"/etc/ld.so.nohwcap"</span>, F_OK)      = <span class="number">-1</span> ENOENT (No such file <span class="keyword">or</span> directory)</span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">8192</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>) = <span class="number">0x7fc78575f000</span></span><br><span class="line">access(<span class="string">"/etc/ld.so.preload"</span>, R_OK)      = <span class="number">-1</span> ENOENT (No such file <span class="keyword">or</span> directory)</span><br><span class="line">open(<span class="string">"/etc/ld.so.cache"</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">fstat(<span class="number">3</span>, &#123;st_mode=S_IFREG|<span class="number">0644</span>, st_size=<span class="number">86757</span>, ...&#125;) = <span class="number">0</span></span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">86757</span>, PROT_READ, MAP_PRIVATE, <span class="number">3</span>, <span class="number">0</span>) = <span class="number">0x7fc785749000</span></span><br><span class="line">close(<span class="number">3</span>)                                = <span class="number">0</span></span><br><span class="line">access(<span class="string">"/etc/ld.so.nohwcap"</span>, F_OK)      = <span class="number">-1</span> ENOENT (No such file <span class="keyword">or</span> directory)</span><br><span class="line">open(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>, O_RDONLY|O_CLOEXEC) = <span class="number">3</span></span><br><span class="line">read(<span class="number">3</span>, <span class="string">"\177ELF\2\1\1\0\0\0\0\0\0\0\0\0\3\0&gt;\0\1\0\0\0P \2\0\0\0\0\0"</span>..., <span class="number">832</span>) = <span class="number">832</span></span><br><span class="line">fstat(<span class="number">3</span>, &#123;st_mode=S_IFREG|<span class="number">0755</span>, st_size=<span class="number">1840928</span>, ...&#125;) = <span class="number">0</span></span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">3949248</span>, PROT_READ|PROT_EXEC, MAP_PRIVATE|MAP_DENYWRITE, <span class="number">3</span>, <span class="number">0</span>) = <span class="number">0x7fc78517a000</span></span><br><span class="line">mprotect(<span class="number">0x7fc785334000</span>, <span class="number">2097152</span>, PROT_NONE) = <span class="number">0</span></span><br><span class="line">mmap(<span class="number">0x7fc785534000</span>, <span class="number">24576</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_DENYWRITE, <span class="number">3</span>, <span class="number">0x1ba000</span>) = <span class="number">0x7fc785534000</span></span><br><span class="line">mmap(<span class="number">0x7fc78553a000</span>, <span class="number">17088</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_FIXED|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>) = <span class="number">0x7fc78553a000</span></span><br><span class="line">close(<span class="number">3</span>)                                = <span class="number">0</span></span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">4096</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>) = <span class="number">0x7fc785748000</span></span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">8192</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>) = <span class="number">0x7fc785746000</span></span><br><span class="line">arch_prctl(ARCH_SET_FS, <span class="number">0x7fc785746740</span>) = <span class="number">0</span></span><br><span class="line">mprotect(<span class="number">0x7fc785534000</span>, <span class="number">16384</span>, PROT_READ) = <span class="number">0</span></span><br><span class="line">mprotect(<span class="number">0x600000</span>, <span class="number">4096</span>, PROT_READ)     = <span class="number">0</span></span><br><span class="line">mprotect(<span class="number">0x7fc785761000</span>, <span class="number">4096</span>, PROT_READ) = <span class="number">0</span></span><br><span class="line">munmap(<span class="number">0x7fc785749000</span>, <span class="number">86757</span>)           = <span class="number">0</span></span><br><span class="line">fstat(<span class="number">1</span>, &#123;st_mode=S_IFCHR|<span class="number">0620</span>, st_rdev=makedev(<span class="number">136</span>, <span class="number">4</span>), ...&#125;) = <span class="number">0</span></span><br><span class="line">mmap(<span class="literal">NULL</span>, <span class="number">4096</span>, PROT_READ|PROT_WRITE, MAP_PRIVATE|MAP_ANONYMOUS, <span class="number">-1</span>, <span class="number">0</span>) = <span class="number">0x7fc78575e000</span></span><br><span class="line">setuid(<span class="number">234323</span>)                          = <span class="number">-1</span> EPERM (Operation <span class="keyword">not</span> permitted)</span><br><span class="line">brk(<span class="number">0</span>)                                  = <span class="number">0x9ba000</span></span><br><span class="line">brk(<span class="number">0x9db000</span>)                           = <span class="number">0x9db000</span></span><br><span class="line">write(<span class="number">1</span>, <span class="string">"hello2  9ba010\n"</span>, <span class="number">15</span>hello2  <span class="number">9b</span>a010</span><br><span class="line">)        = <span class="number">15</span></span><br><span class="line">exit_group(<span class="number">0</span>)                           = ?</span><br><span class="line">+++ exited with <span class="number">0</span> +++</span><br></pre></td></tr></table></figure>
<p>其实这里比较好的方式是gdb,单步调试，这个有兴趣再做吧；<br>运行的时候，是执行execve系列函数，将可执行文件加载后，转换为进程运行，这个时候，做的事情很多，需要创建新进程，需要将可执行文件映射到进程对应的内存区，并建立各个vma区域，对依赖的符号做库加载和映射，然后进程实例结构建立好后，根据进程需要的资源和当前运行状态，加入对应的进程相关队列，等待执行；</p>
<ul>
<li>至此，一个程序，从源文件，到可执行文件，到链接，转换为进程，运行结束，一个周期完结；</li>
</ul>
<h3 id="具体解释：预处理"><a href="#具体解释：预处理" class="headerlink" title="具体解释：预处理"></a>具体解释：预处理</h3><p>1) 预处理阶段<br>c/c++是编译类型的语言，即c/c++源文件，是比较符合人类语言的文本文件，需要将这个文件翻译为机器能直接执行的可执行文件，这个翻译成可执行文件的过程，就是编译的过程；<br>程序在编译的过程中，需要经过几个阶段，第一个阶段是预处理阶段：<br>在正式的编译阶段之前进行。预处理阶段将根据已放置在文件中的预处理指令来修改源文件的内容。<br>如#include指令就是一个预处理指令，它把头文件的内容添加到.cpp文件中。<br>预处理指令，不是真正的程序语句，而是给预处理器的命令；<br>2) 预处理的指令：<br>预处理指令不止于#include,还有：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> </span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span></span></span><br><span class="line"><span class="meta">#end</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span></span></span><br><span class="line">一些已定义好的宏：</span><br><span class="line">__LINE__	整数值，表示当前正在编译的行在源文件中的行数。</span><br><span class="line">__FILE__	字符串，表示被编译的源文件的文件名。</span><br><span class="line">__DATE__	一个格式为 <span class="string">"Mmm dd yyyy"</span> 的字符串，存储编译开始的日期。</span><br><span class="line">__TIME__	一个格式为 <span class="string">"hh:mm:ss"</span> 的字符串，存储编译开始的时间。</span><br><span class="line">__cplusplus	整数值，所有C++编译器都定义了这个常量为某个值。如果这个编译器是完全遵守C++标准的，它的值应该等于或大于<span class="number">199711L</span>，具体值取决于它遵守的是哪个版本的标准。</span><br><span class="line">ref: 见手册；</span><br></pre></td></tr></table></figure></p>
<p>预处理阶段，是预处理器对预处理指令的解析，并将解析后的内容输出出来或者到下个阶段的输入；<br>实践：<br>3) 例子：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="built_in">printf</span>(<span class="string">"hello world\n"</span>);</span><br><span class="line">   <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">gcc -E test.c -o test.i 或 gcc -E test.c  或用cpp</span><br><span class="line">将它进行预处理：gcc -E simplest.c 可以看到没有引用到其他头文件：</span><br><span class="line"></span><br><span class="line"># <span class="number">1</span> <span class="string">"simplest.c"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;built-in&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;command-line&gt;"</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"/usr/include/stdc-predef.h"</span> <span class="number">1</span> <span class="number">3</span> <span class="number">4</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"&lt;command-line&gt;"</span> <span class="number">2</span></span><br><span class="line"># <span class="number">1</span> <span class="string">"simplest.c"</span></span><br><span class="line">stdio.h的内容在这里铺开;</span><br><span class="line">包含了各种函数的声明；</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">"hello world\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>其他c/cpp文件也是一样，但是一个程序(进程)只能有一个main函数<br>PS:关于g++和gcc的不同： g++ 比gcc 多了一些库的链接功能，当使用了c++的标准库的时候，必须用g++;</p>
<p>4) 说明：<br>预处理中的#include指令，在编译器处理后，会将对应的头文件展开，这样，其中的函数声明就能展开在引用头文件的源码文件中，当之后编译程序时，用到的符号，<br>声明就能被找到；</p>
<h3 id="具体解释：编译"><a href="#具体解释：编译" class="headerlink" title="具体解释：编译"></a>具体解释：编译</h3><h4 id="编译阶段概述："><a href="#编译阶段概述：" class="headerlink" title="编译阶段概述："></a>编译阶段概述：</h4><p>这个阶段，编译器会把每个实现文件，结合头文件编译成中间文件(其实编译过程是不需要头文件的，原因是一些文件中会引用头文件中的函数等符号，所以需要，而也可以引用.c文件，但是会出现重复定义，而声明是可以重复)，一般是一个二进制.o文件，并进行相关的编译器优化，即将一些语句顺序进行调节等；<br>先把源文件翻译成汇编文件，再通过汇编器将汇编文件翻译为二进制文件；</p>
<h4 id="一个例子："><a href="#一个例子：" class="headerlink" title="一个例子："></a>一个例子：</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">m</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">   <span class="keyword">int</span> a = <span class="number">3</span>;</span><br><span class="line">   <span class="keyword">return</span> a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>gcc -S hh.cpp<br>生成hh.s:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">	.file	<span class="string">"hh.cpp"</span></span><br><span class="line">	.text</span><br><span class="line">	.globl	_Z1mv</span><br><span class="line">	.type	_Z1mv, @function</span><br><span class="line">_Z1mv:</span><br><span class="line">.LFB0:</span><br><span class="line">	.cfi_startproc</span><br><span class="line">	pushq	%rbp</span><br><span class="line">	.cfi_def_cfa_offset <span class="number">16</span></span><br><span class="line">	.cfi_offset <span class="number">6</span>, <span class="number">-16</span></span><br><span class="line">	movq	%rsp, %rbp</span><br><span class="line">	.cfi_def_cfa_register <span class="number">6</span></span><br><span class="line">	movl	$<span class="number">3</span>, <span class="number">-4</span>(%rbp)</span><br><span class="line">	movl	<span class="number">-4</span>(%rbp), %eax</span><br><span class="line">	popq	%rbp</span><br><span class="line">	.cfi_def_cfa <span class="number">7</span>, <span class="number">8</span></span><br><span class="line">	ret</span><br><span class="line">	.cfi_endproc</span><br><span class="line">.LFE0:</span><br><span class="line">	.size	_Z1mv, .-_Z1mv</span><br><span class="line">	.ident	<span class="string">"GCC: (Ubuntu 4.8.4-2ubuntu1~14.04.4) 4.8.4"</span></span><br><span class="line">	.section	.note.GNU-<span class="built_in">stack</span>,<span class="string">""</span>,@progbits</span><br></pre></td></tr></table></figure>
<p>暂时不解析</p>
<h4 id="编译时不需要依赖的调用的实现"><a href="#编译时不需要依赖的调用的实现" class="headerlink" title="编译时不需要依赖的调用的实现"></a>编译时不需要依赖的调用的实现</h4><p>编译期间，都是用的-c生成各种.o文件，进而是静态库或动态库，或者单纯的有main函数的中间文件；<br>这个时候不需要在编译时提供依赖的实现文件，比如依赖的函数实现文件，只需要头文件即可生成；<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">eg:</span><br><span class="line">dep.h:</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">def</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">hello.cpp</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"dep.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hello</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    def();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">hello.h</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">hello</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">main.cpp</span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"hello.h"</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    hello();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>编译：<br>gcc -c hello.cpp</p>
<p>gcc -c main.cpp</p>
<p>生成可执行时才需要链接：这个时候需要所有的实现接口对应点的实现文件：或以库的形式，或以动态库的形式，或者实现文件.o/.cpp<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">keshixing@ubuntu:~/testld$ g++ -o main main.cpp hello.o</span><br><span class="line">/usr/bin/ld: hello.o: in function `hello()<span class="string">':</span></span><br><span class="line">hello.cpp:(.text+0x9): undefined reference to `def()'</span><br><span class="line">collect2: error: ld returned <span class="number">1</span> <span class="built_in">exit</span> status</span><br></pre></td></tr></table></figure></p>
<p>这里没有实现def()所以报错了；</p>
<p>编译过程中汇编器将汇编文件翻译为.o中间文件，这里汇编器其实已经包含到gcc中了，也可以自己下载一个特定平台的比如：NASM<br>输出可执行程序时，必须实现入口函数，比如main;<br>gcc -o main main.s</p>
<h4 id="编译过程总结："><a href="#编译过程总结：" class="headerlink" title="编译过程总结："></a>编译过程总结：</h4><p>关于编译过程涉及如何将源程序转换为汇编程序，主要是编译器的部分工作，具体是词法分析，语法分析等，有著名的lex,yacc工具，也有<br>对应的状态机等逻辑，内容很多，有兴趣可以看编译原理 龙书；</p>
<p>这里，记录下：对编译后的程序单元，得到的是什么：是一种elf格式的文件，对linux来说；<br>elf文件，有以下几种类型：<br>可重定位文件： relocatable file .o文件<br>可执行文件：executable file<br>共享目标文件：shared object file ，通常是so动态库<br>dump文件： core-dump file </p>
<p>所以编译的结果，是生成第一种elf目标文件；<br>而主要的内容：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> elf格式头</span><br><span class="line"><span class="number">2</span> elf格式的各个段</span><br><span class="line"><span class="number">3</span> elf各个段的内容，比如代码段，里面包括了编译后的代码等；</span><br><span class="line"><span class="number">4</span> 符号表；</span><br><span class="line"><span class="number">5</span> 。。。</span><br><span class="line"></span><br><span class="line">其中最重要的，就是代码段和数据段，符号表等；</span><br><span class="line">代码段，展示了这个目标文件的功能了流程，数据段，表示了存放的全局数据等，符号表，展示了这个目标文件提供了哪些可以被外部使用的符号，以及</span><br><span class="line">依赖的哪些符号；以便链接使用</span><br></pre></td></tr></table></figure></p>
<h3 id="具体解释：链接"><a href="#具体解释：链接" class="headerlink" title="具体解释：链接"></a>具体解释：链接</h3><h4 id="基本概述："><a href="#基本概述：" class="headerlink" title="基本概述："></a>基本概述：</h4><ul>
<li>链接的来源：<br>写一个程序，需要定义各种函数，当只有一个源文件，编译为一个可执行程序时，这个时候，调用函数的地方直接填上函数的地址，看起来没什么问题；<br>但是当调整函数的定义时，不考虑其他因素，则函数的基地址在代码段中的位置，又会发生变化，这个时候，调用的位置有需要修改，这个是一个繁琐的工作；</li>
</ul>
<p>于是这里提供了符号的方式，调用函数的地方，转换为符号，根据符号寻找对应的地址，这样，即使修改函数，也不用改调用的地方；</p>
<p>当程序越来越大，拆分为多个目标文件模块，这个时候，对外部符号的链接 ，有两种形式：<br>一种是在产生可执行程序，链接时，将外部符号对应的定义模块，结合<br>到调用的文件中，程序通过符号表和重定位等，转换为正确的地址；程序包含符号对应函数的定义，执行时可以直接运行，不依赖外部库；<br>这种形式是静态链接</p>
<p>另一种形式，在链接时，并不是将实现的代码结合进去，只是带符号，而在运行时，依赖对应的系统上的动态库；执行时再根据调用的符号，到对应<br>的系统上寻找动态库，加载到内存中，来执行；</p>
<ul>
<li>链接的进一步解释和相关命令：<br>关于编译时的链接：<br>我们在编译一个完整的程序时，除了指定含有main函数的程序文件外，这个文件还可能依赖定义在其他源程序中的函数，这个时候，编译时需要指定如：<br>gcc -o main main.cpp func.cpp …<br>有时候这些源文件以编译好的.o的形式呈现，也可以进行：gcc -o main main.cpp func.o<br>而当许多.o需要指定比较麻烦，所以库出现了，用来将.o文件汇总，分为两种形式，一种是静态库，一种是动态库；<br>静态库，就是在编译时将文件的执行代码都聚合到可执行文件中，包括调用的功能函数等，执行时不需要额外的库支持；编译出来的可执行文件会比较大；<br>动态库，即在编译时只是将调用的函数符号指定到符号表中，在执行时才去系统默认库路径(头文件指定的)寻找库,并链接该函数执行；</li>
</ul>
<p>静态链接：在编译时，要指定链接的静态库，包括位置等；<br>eg:<br>gcc -o main main.cpp func.a /home/zhangsan/lib/funall.a local/local.a<br>动态链接：编译时，需要指定链接的动态库，包括位置等；默认会找默认位置的动态库<br>gcc -o main main.cpp -L./xxx   -lcurl -lpthread<br>-L./xx 为指定了目录下有动态链接库，也可以链接成功；<br>注意形式为：libxxx.so 链接为 -lxxx<br>在运行的时候：<br>ldd a.out这种可以得到可执行文件希望在哪里找到库；而一般要设置export LD_LIBRARY_PATH=/home/think/c++/ 或者放在<br>系统默认搜索路径下，或者修改系统文件/etc/ld.so.conf，添加路径，运行ldconfig命令<br>默认搜索路径：<br>/lib<br>/usr/lib<br>/usr/local/lib </p>
<h4 id="静态链接"><a href="#静态链接" class="headerlink" title="静态链接"></a>静态链接</h4><p>静态链接用到的技术：</p>
<ul>
<li><p>如何将模块.o文件合并到输出的可执行文件：地址和空间分配<br>需要考虑字节对齐等，每个模块文件的格式都是类似，有各个对应的段，这样可以将相似的段进行合并；<br>比如.text -&gt;.text</p>
</li>
<li><p>符号解析和重定位：<br>在将段合并后，各个符号对应的函数等(相对位置)已经确定了，这样可以进行符号解析，调整代码中的地址等；<br>1) 可以通过objdump -h xx.o 和可执行文件的对比，看到text段等段的相对偏移位置已经确定了；<br>2) 可以通过objdump -d xx.o 和objdump -d xxmain来对比链接前后，对外部符号如全局变量和函数的汇编语句中的地址数值，是不是<br>从0-&gt;真正的位置；<br>在elf文件中，有个 结构叫重定位表（relocation table),具体见elf格式解析，专门存放和重定位相关的信息；<br>.rel.xxx<br>3) 链接器会在链接时，去重定位表中找到对应符号的地址，然后进行符号解析，将符号改为正在的相对地址；</p>
</li>
<li><p>相关命令：<br>1）链接的符号查看： nm xxx.o可以看到提供的符号和依赖的符号；<br>2） ld main.o func.o -e main -o abc -lc<br>3) ar -t libc.a 查看a文件中有哪些o文件；<br>4） gcc -static  –verbose -fno-builtin xx.c 输出详细信息，编译时；</p>
</li>
<li><p>链接过程控制–链接脚本：<br>链接器提供了多种控制整个链接过程的方法：<br>1) 提供命令行来给链接器指定参数；<br>2) 将链接指令存放在目标文件中；比如vc中经常使用<br>3) 使用链接脚本：在使用ld时，使用ld -T xxx.script</p>
</li>
</ul>
<p>一个例子说明链接脚本是做什么的：<br><a href="https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_chapter/ld_3.html" target="_blank" rel="noopener">https://ftp.gnu.org/old-gnu/Manuals/ld-2.9.1/html_chapter/ld_3.html</a></p>
<h3 id="具体解释：装载和动态链接"><a href="#具体解释：装载和动态链接" class="headerlink" title="具体解释：装载和动态链接"></a>具体解释：装载和动态链接</h3><h4 id="概述："><a href="#概述：" class="headerlink" title="概述："></a>概述：</h4><p>进程和程序有什么不同？</p>
<h4 id="进程的虚拟地址空间"><a href="#进程的虚拟地址空间" class="headerlink" title="进程的虚拟地址空间"></a>进程的虚拟地址空间</h4><h4 id="程序装载是什么，装载有什么方式？"><a href="#程序装载是什么，装载有什么方式？" class="headerlink" title="程序装载是什么，装载有什么方式？"></a>程序装载是什么，装载有什么方式？</h4><p>装载其实，就是将磁盘中的程序文件，按一定的格式，载入到内存中；这其中会用到页映射等操作系统对文件和内存管理的部分功能；<br>装载，只是程序转换为进程的其中一个步骤，一个程序，如何转换为一个进程？<br>1) 通过execvl系列函数，建立进程；创建一个独立的虚拟地址空间；<br>2) 读取可执行文件，将可执行文件映射到进程虚拟地址空间中，并建立各个段-vma 区域，一个vma由多个段组成；<br>3) 当调度器调度到此进程，将cpu指令寄存器设置为进程中可执行段的入口，启动运行<br>这之后，其实可执行程序并未全部都载入到内存中，在执行过程中，会出现缺页错误，然后操作系统进行处理，但是用户无感知；</p>
<h4 id="动态链接："><a href="#动态链接：" class="headerlink" title="动态链接："></a>动态链接：</h4><ul>
<li>为什么要动态链接：<br>如果用静态链接，可执行程序过大，副本多，占用磁盘大，不好传输，模块更新困难等等；<br>动态链接，是在执行程序的过程中发生的：具体来讲，发生在装载的时候；</li>
<li>动态链接如何实现？<br>在linux中，elf动态链接文件叫共享对象 dynamic shared obj<br>动态链接的程序，在程序被装载时，系统的动态链接器会将程序需要的所有动态链接库装载到进程的地址空间，并将所有未决议的符号<br>绑定到相应的动态链接库中，并进行重定位； 注意动态链接器和静态链接器不同；</li>
</ul>
<p>动态链接，会将链接和重定位的工作放到了运行时，这样会导致程序性能下降，但动态链接器也做了一些优化，比如延迟绑定等；</p>
<ul>
<li><p>如何生成动态库：<br>gcc -fPIC -shared -o xx.so xx.c</p>
</li>
<li><p>运行时查看进程的各个段映射：<br>cat /proc/pid/maps</p>
</li>
</ul>
<ul>
<li>动态链接库中的代码可以被多个程序共享，由此带来重定位的问题：<br>1) 原因：<br>动态库被装载时，共享对象，如何确定它在进程虚拟地址空间中的位置？ 装载时重定位，即类似静态链接，在模块装载地址确定时，系统对<br>程序中所有的绝对地址引用进行重定位。但是这个对不同进程来说，会产生不同的地址；所以同一份指令在被多个进程共享时会出现问题。无法做到共享省内存<br>的目的；这种方法其实就是-shared;</li>
</ul>
<p>2) 进阶：使用-fPIC: 地址无关代码： position-independent-code<br>可以解决以上办法，但是只能有部分可以达到目的：部分指令在多个进程间是无法共享的，所以需要将这部分抽离处理和数据段放在一起；<br>对数据，函数引用来说有以下四种，只有两种可以：<br>(1) 模块内部的函数调用，跳转  相对位置固定，不需要重定位<br>(2) 模块内部的数据访问，比如模块中定义的全局变量，静态变量 相对位置固定，不需要重定位<br>(3) 模块外部函数的调用，跳转   依赖外部符号，需要将其放到数据段，使用全局偏移表 GOT<br>(4) 模块外的数据访问，比如用到了其他模块中定义的全局变量；需要用GOT表<br>使用-fPIC就是用来产生地址无关代码的</p>
<ul>
<li>延迟绑定</li>
</ul>
<ul>
<li>动态链接相关结构：<br>1）.interp段<br>2) .dynamic段<br>3) 动态链接符号表等；<br>4）动态链接重定位表</li>
</ul>
<h3 id="关于编译，链接形成的目标文件；"><a href="#关于编译，链接形成的目标文件；" class="headerlink" title="关于编译，链接形成的目标文件；"></a>关于编译，链接形成的目标文件；</h3><h4 id="关于目标文件："><a href="#关于目标文件：" class="headerlink" title="关于目标文件："></a>关于目标文件：</h4><p>在编译时除了可以生成可执行文件，还可以生产静态库，动态库，中间文件，汇编文件等，这里看静态库和动态库的生成规则<br>生成静态库文件：<br>ar rvs libfunc.a func.o func2.o<br>man ar 查看更多<br>生成动态库文件:<br>gcc func.cpp  -fPIC -shared -o libfunc.so<br>-shared 该选项指定生成动态连接库（让连接器生成T类型的导出符号表，有时候也生成弱连接W类型的导出符号），不用该标志外部程序无法连接<br>Produce a shared object which can then be linked with other objects to form an executable.  Not all systems support this option.  For predictable results, you must also specify the same</p>
<p>-fPIC：表示编译为位置独立的代码，不用此选项的话编译后的代码是位置相关的所以动态载入时是通过代码拷贝的方式来满足不同进程的需要，而不能达到真正代码段共享的目的。<br>更多见man gcc<br>5) 总：<br>一个完整的gcc/g++编译命令，除了指定上面的内容，还需要指定头文件的位置，默认目录有哪些？，优化选项，-c/-o/-S/-E其他选项等，这里把这些汇总下，并给上参考地址方便查阅；man gcc<br>-c:  -c  Compile or assemble the source files, but do not link.  The linking stage simply is not done.  The ultimate output is in the form of an object file for each source file.<br>-I: 指定头文件的路径<br>gcc -I. -I /home/include/ ..<br>指定了头文件路径后，在#include时可以省略路径；</p>
<h4 id="elf格式"><a href="#elf格式" class="headerlink" title="elf格式"></a>elf格式</h4><p>/usr/include/elf.h中包含了elf文件结构的各个字段格式；<br><a href="https://refspecs.linuxfoundation.org/elf/elf.pdf" target="_blank" rel="noopener">https://refspecs.linuxfoundation.org/elf/elf.pdf</a><br>或者书籍： 程序员的自我修养等可以查阅到具体信息；</p>
<h3 id="关于入口函数和运行时库CRT："><a href="#关于入口函数和运行时库CRT：" class="headerlink" title="关于入口函数和运行时库CRT："></a>关于入口函数和运行时库CRT：</h3><p>入口函数不一定是main，在main调用之前，为了程序能顺利运行，需要初始化程序的执行环节，如堆分配初始化等，以及c++中的<br>全局对象构造函数，都在main之前执行，而全局对象的析构函数在main之后被执行；<br>这个依赖于elf中的两种特殊的段： .init .finit<br>所以在链接后，程序最开始运行的，不是main，而是.init中指定的入口函数，它可能包括各种初始化，如运行时库的入口函数，c++全局对象的构造函数，等等；</p>
<ul>
<li>运行时库：<br>一个c运行时库大概包括如下功能：<br>1) 启动和退出，包括入口函数及其依赖<br>2) 标准库函数集合<br>3) IO的封装<br>4) 堆的分配等封装<br>5) 语言中一些特殊功能实现<br>6) 调试功能；</li>
</ul>
<p>另外，链接脚本或参数也可以指定不是main作为主函数，而是用别的名字，如ld -e nomain</p>
<h3 id="关键词："><a href="#关键词：" class="headerlink" title="关键词："></a>关键词：</h3><p>ABI： 指的是不同的cpu架构，操作系统，编译器类型甚至版本带来的目标文件差异；<br>BFD库： 为了解决多种cpu，大小端下，可执行程序兼容性问题，提供了统一的格式；</p>
<h3 id="其他："><a href="#其他：" class="headerlink" title="其他："></a>其他：</h3><h5 id="c-c-的反汇编，二进制查看，可执行文件格式等；"><a href="#c-c-的反汇编，二进制查看，可执行文件格式等；" class="headerlink" title="c/c++的反汇编，二进制查看，可执行文件格式等；"></a>c/c++的反汇编，二进制查看，可执行文件格式等；</h5><p>1) 可执行文件的结构：<br>think@think-VirtualBox:~/c++$ size hh.o<br>   text       data        bss        dec        hex    filename<br>     72          0          0         72         48    hh.o<br>代码段：只读，可共享，代码中的常量数据在编译时在代码段中分配空间，如int x=3;中的3及const 声明的常量和字符串常量;还有就是代码本身的0101机器码<br>数据段：为全局初始化数据区和静态数据区：已经初始化的全局变量和静态变量（全局和局部）<br>bss:为初始化数据取，存放为初始化的全局变量和静态变量，但在开始执行时会被内核赋值０或null</p>
<p>2）如何反汇编；<br>objdump 工具，除了可以反汇编，还可以查看二进制文件等：<br>objdump -s hh.o : 查看十六进制<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">think@think-VirtualBox:~/c++$ objdump -s  hh.o</span><br><span class="line"></span><br><span class="line">hh.o:     file format elf64-x86<span class="number">-64</span></span><br><span class="line"></span><br><span class="line">Contents of section .text:</span><br><span class="line"> <span class="number">0000</span> <span class="number">554889e5</span> c745fc03 <span class="number">0000008b</span> <span class="number">45f</span>c5dc3  UH...E......E.].</span><br><span class="line">Contents of section .comment:</span><br><span class="line"> <span class="number">0000</span> <span class="number">00474343</span> <span class="number">3</span>a202855 <span class="number">62756e74</span> <span class="number">7520342</span>e  .GCC: (Ubuntu <span class="number">4.</span></span><br><span class="line"> <span class="number">0010</span> <span class="number">382e342</span>d <span class="number">32756275</span> <span class="number">6e747531</span> <span class="number">7e31342</span>e  <span class="number">8.4</span><span class="number">-2u</span>buntu1~<span class="number">14.</span></span><br><span class="line"> <span class="number">0020</span> <span class="number">30342e34</span> <span class="number">2920342</span>e <span class="number">382e3400</span>           <span class="number">04.4</span>) <span class="number">4.8</span><span class="number">.4</span>.    </span><br><span class="line">Contents of section .eh_frame:</span><br><span class="line"> <span class="number">0000</span> <span class="number">14000000</span> <span class="number">00000000</span> <span class="number">017</span>a5200 <span class="number">01781001</span>  .........zR..x..</span><br><span class="line"> <span class="number">0010</span> <span class="number">1b</span>0c0708 <span class="number">90010000</span> <span class="number">1</span>c000000 <span class="number">1</span>c000000  ................</span><br><span class="line"> <span class="number">0020</span> <span class="number">00000000</span> <span class="number">10000000</span> <span class="number">00410e10</span> <span class="number">8602430</span>d  .........A....C.</span><br><span class="line"> <span class="number">0030</span> <span class="number">064b</span>0c07 <span class="number">08000000</span>                    .K......</span><br></pre></td></tr></table></figure></p>
<p> objdump -d hh.o: 反汇编：</p>
<h3 id="运行时："><a href="#运行时：" class="headerlink" title="运行时："></a>运行时：</h3><h5 id="c-c-文件如何执行，动态链接如何进行；"><a href="#c-c-文件如何执行，动态链接如何进行；" class="headerlink" title="c/c++文件如何执行，动态链接如何进行；"></a>c/c++文件如何执行，动态链接如何进行；</h5><p>c/c++可执行文件如何执行呢？<br>可执行文件分为完整的非动态链接的可执行文件和完整的静态链接的可执行文件<br>1）静态链接：在./a.out的时候，会通过触发起一个execl系列函数，起一个进程，并开始执行，执行过程即会创建进程空间，内核管理，内核分时间片运行；<br>即作为一个进程来运行，而进程有自己的生命周期：就绪，运行，阻塞等等，也有各种进程上下文，当前的资源等等；<br>总的来讲： 生命周期，进程管理的私有结构，进程的动态空间：堆，栈，虚拟地址空间，各种阻塞队列等等；<br>2）动态链接：动态链接的可执行文件，需要搜索路径下有依赖的动态库，否则无法运行，在运行时会通过链接的符号等去寻找对应的动态库函数实现，加载调用运行；<br>之后的运行和静态链接基本一致；</p>
<h5 id="gdb基础和gdb常用，手册等；"><a href="#gdb基础和gdb常用，手册等；" class="headerlink" title="gdb基础和gdb常用，手册等；"></a>gdb基础和gdb常用，手册等；</h5><p>当编译时带上-g后即带debug信息，运行时即可以进行gdb 运行；<br>gdb main<br>gdb attach 挂的是线程还是进程？<br>见gdb文章</p>
<h4 id="c-程序执行过程调试例子，注意执行语句先后，编译器优化前后不同"><a href="#c-程序执行过程调试例子，注意执行语句先后，编译器优化前后不同" class="headerlink" title="c++程序执行过程调试例子，注意执行语句先后，编译器优化前后不同"></a>c++程序执行过程调试例子，注意执行语句先后，编译器优化前后不同</h4><h4 id="堆栈空间表现例子"><a href="#堆栈空间表现例子" class="headerlink" title="堆栈空间表现例子"></a>堆栈空间表现例子</h4><p>堆栈空间如何增长呢？<br>跟cpu系统有关，暂时不深究；要知道new/malloc是在堆上分配空间，普通定义数组，变量是在栈上分配空间；<br>struct class这种的，定义一个非指针变量，是放栈还是堆？</p>
<h4 id="多线程相关调试例子；"><a href="#多线程相关调试例子；" class="headerlink" title="多线程相关调试例子；"></a>多线程相关调试例子；</h4><p>1）查看多线程pid: top -Hp pid<br>2) 多线程是系统层面的，多线程的实现可以是用系统的接口，比如posix的pthread,fork进程等，或者用语言的thread ,这种最后也是调用的pthread系列函数；<br>这里默认都是unix系统；<br>3）使用linux系统工具调试多线程程序；</p>
<h4 id="linux-core-dump机制和相关工具"><a href="#linux-core-dump机制和相关工具" class="headerlink" title="linux core-dump机制和相关工具"></a>linux core-dump机制和相关工具</h4><p>1) core-dump是什么？<br>2）core-dump如何触发？</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/compilelink/" rel="tag"># compilelink</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/02/17/live-media-audioformat/" rel="prev" title="live_media_audioformat">
      <i class="fa fa-chevron-left"></i> live_media_audioformat
    </a></div>
      <div class="post-nav-item">
    <a href="/2021/02/20/sk-buff/" rel="next" title="sk_buff">
      sk_buff <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          
    <div class="comments" id="gitalk-container"></div>

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#关于编译链接执行，编译器和cpu相关"><span class="nav-number">1.</span> <span class="nav-text">关于编译链接执行，编译器和cpu相关</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#一个简单例子"><span class="nav-number">2.</span> <span class="nav-text">一个简单例子</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#各自预处理后："><span class="nav-number">2.1.</span> <span class="nav-text">各自预处理后：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#接着编译为汇编文件："><span class="nav-number">2.2.</span> <span class="nav-text">接着编译为汇编文件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编译为目标文件："><span class="nav-number">2.3.</span> <span class="nav-text">编译为目标文件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#接下来链接："><span class="nav-number">2.4.</span> <span class="nav-text">接下来链接：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#接着来追踪下程序的运行："><span class="nav-number">2.5.</span> <span class="nav-text">接着来追踪下程序的运行：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#具体解释：预处理"><span class="nav-number">3.</span> <span class="nav-text">具体解释：预处理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#具体解释：编译"><span class="nav-number">4.</span> <span class="nav-text">具体解释：编译</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#编译阶段概述："><span class="nav-number">4.1.</span> <span class="nav-text">编译阶段概述：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#一个例子："><span class="nav-number">4.2.</span> <span class="nav-text">一个例子：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编译时不需要依赖的调用的实现"><span class="nav-number">4.3.</span> <span class="nav-text">编译时不需要依赖的调用的实现</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编译过程总结："><span class="nav-number">4.4.</span> <span class="nav-text">编译过程总结：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#具体解释：链接"><span class="nav-number">5.</span> <span class="nav-text">具体解释：链接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#基本概述："><span class="nav-number">5.1.</span> <span class="nav-text">基本概述：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#静态链接"><span class="nav-number">5.2.</span> <span class="nav-text">静态链接</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#具体解释：装载和动态链接"><span class="nav-number">6.</span> <span class="nav-text">具体解释：装载和动态链接</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#概述："><span class="nav-number">6.1.</span> <span class="nav-text">概述：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#进程的虚拟地址空间"><span class="nav-number">6.2.</span> <span class="nav-text">进程的虚拟地址空间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#程序装载是什么，装载有什么方式？"><span class="nav-number">6.3.</span> <span class="nav-text">程序装载是什么，装载有什么方式？</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#动态链接："><span class="nav-number">6.4.</span> <span class="nav-text">动态链接：</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于编译，链接形成的目标文件；"><span class="nav-number">7.</span> <span class="nav-text">关于编译，链接形成的目标文件；</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#关于目标文件："><span class="nav-number">7.1.</span> <span class="nav-text">关于目标文件：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#elf格式"><span class="nav-number">7.2.</span> <span class="nav-text">elf格式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关于入口函数和运行时库CRT："><span class="nav-number">8.</span> <span class="nav-text">关于入口函数和运行时库CRT：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#关键词："><span class="nav-number">9.</span> <span class="nav-text">关键词：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他："><span class="nav-number">10.</span> <span class="nav-text">其他：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#c-c-的反汇编，二进制查看，可执行文件格式等；"><span class="nav-number">10.0.1.</span> <span class="nav-text">c/c++的反汇编，二进制查看，可执行文件格式等；</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#运行时："><span class="nav-number">11.</span> <span class="nav-text">运行时：</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#c-c-文件如何执行，动态链接如何进行；"><span class="nav-number">11.0.1.</span> <span class="nav-text">c/c++文件如何执行，动态链接如何进行；</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#gdb基础和gdb常用，手册等；"><span class="nav-number">11.0.2.</span> <span class="nav-text">gdb基础和gdb常用，手册等；</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#c-程序执行过程调试例子，注意执行语句先后，编译器优化前后不同"><span class="nav-number">11.1.</span> <span class="nav-text">c++程序执行过程调试例子，注意执行语句先后，编译器优化前后不同</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#堆栈空间表现例子"><span class="nav-number">11.2.</span> <span class="nav-text">堆栈空间表现例子</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多线程相关调试例子；"><span class="nav-number">11.3.</span> <span class="nav-text">多线程相关调试例子；</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#linux-core-dump机制和相关工具"><span class="nav-number">11.4.</span> <span class="nav-text">linux core-dump机制和相关工具</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="小兴"
      src="/images/headicon2.jpg">
  <p class="site-author-name" itemprop="name">小兴</p>
  <div class="site-description" itemprop="description">始于歧路，愿归于征途</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">57</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
        <span class="site-state-item-count">12</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">33</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/xdksx/" title="GitHub → https://github.com/xdksx/" rel="noopener" target="_blank"><i class="fa fa-fw fa-github-square"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="/ksance@gmail.com" title="E-Mail → ksance@gmail.com"><i class="fa fa-fw fa-envelope"></i></a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.facebook.com/572897439" title="FB Page → https://www.facebook.com/572897439" rel="noopener" target="_blank"><i class="fa fa-fw fa-facebook"></i></a>
      </span>
  </div>


  <div class="links-of-blogroll motion-element">
    <div class="links-of-blogroll-title">
      <i class="fa fa-fw fa-link"></i>
      friendly link
    </div>
    <ul class="links-of-blogroll-list">
        <li class="links-of-blogroll-item">
          <a href="http://yoursite.com" title="http://yoursite.com" rel="noopener" target="_blank">Title</a>
        </li>
    </ul>
  </div>

      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 2019 – 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">小兴</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.7.1
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.2
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script>
<script src="/js/schemes/pisces.js"></script>
<script src="/js/next-boot.js"></script>



  




  <script src="/js/local-search.js"></script>












  

  

<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">

<script>
NexT.utils.loadComments(document.querySelector('#gitalk-container'), () => {
  NexT.utils.getScript('//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js', () => {
    var gitalk = new Gitalk({
      clientID    : '06e6b70d396f6928e45a',
      clientSecret: 'cd03b7c657d50a5d76a7fa682c4f8eb48cb15fc3',
      repo        : 'xdksx.github.io',
      owner       : 'xdksx',
      admin       : ['xdksx'],
      id          : '1a3a207d1003d1106624b634c9d2f6bd',
        language: '',
      distractionFreeMode: true
    });
    gitalk.render('gitalk-container');
  }, window.Gitalk);
});
</script>

</body>
</html>
